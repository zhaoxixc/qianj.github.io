<div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-01-04T08:40:53.000Z" title="2024/1/4 16:40:53">2024-01-04</time>发表</span><span class="level-item"><time dateTime="2024-01-04T09:21:38.625Z" title="2024/1/4 17:21:38">2024-01-04</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/qianj-work/">qianj-work</a></span><span class="level-item">5 分钟读完 (大约761个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">virsh命令</h1><div class="content"><!-- more -->
<p>virsh 命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">virsh list <span class="comment"># 列出所有运行的虚拟机                                       </span></span><br><span class="line">virsh list --all  <span class="comment"># 列出所有虚拟机</span></span><br><span class="line"> </span><br><span class="line">virsh hostname  	<span class="comment"># 列出真机主机名</span></span><br><span class="line">virsh sysinfo   	<span class="comment"># 列出真机的详细信息</span></span><br><span class="line">virsh nodecpustats  	<span class="comment"># 得到真机cpu状态</span></span><br><span class="line">virsh nodememstats   	<span class="comment"># 得到真机内存状态</span></span><br><span class="line">virsh node-memory-tune  <span class="comment"># 允许你设置的node内存参数</span></span><br><span class="line">virsh capabilities  	<span class="comment"># 打印虚拟机的特点</span></span><br><span class="line">virsh freecell  	<span class="comment"># 打印虚拟机中可用内存</span></span><br><span class="line">virsh shutdown dns 	<span class="comment"># 关闭虚拟机dns</span></span><br><span class="line">virsh start dns    	<span class="comment"># 启动虚拟机dns</span></span><br><span class="line">virsh dumpxml dns &gt; dns.xml   <span class="comment"># 导出dns虚拟机的配置文件</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">virsh --<span class="built_in">help</span>                                     <span class="comment">#查看命令帮忙</span></span><br><span class="line">virsh list                                       <span class="comment">#显示正在运行的虚拟机</span></span><br><span class="line">virsh list --all                                 <span class="comment">#显示所有的虚拟机</span></span><br><span class="line">virsh start vm-node1                             <span class="comment">#启动vm-node1虚拟机</span></span><br><span class="line">virsh shutdown vm-node1                          <span class="comment">#关闭vm-node1虚拟机</span></span><br><span class="line">virsh destroy vm-node1                           <span class="comment">#虚拟机vm-node1强制断电</span></span><br><span class="line">virsh <span class="built_in">suspend</span> vm-node1                           <span class="comment">#挂起vm-node1虚拟机</span></span><br><span class="line">virsh resume vm-node1                            <span class="comment">#恢复挂起的虚拟机</span></span><br><span class="line">virsh undefine vm-node1                          <span class="comment">#删除虚拟机，慎用</span></span><br><span class="line">virsh dominfo vm-node1                           <span class="comment">#查看虚拟机的配置信息</span></span><br><span class="line">virsh domiflist                                  <span class="comment">#查看网卡配置信息</span></span><br><span class="line">virsh domblklist vm-node1                        <span class="comment">#查看该虚拟机的磁盘位置</span></span><br><span class="line">virsh edit vm-node1                              <span class="comment">#修改vm-node1的xml配置文件</span></span><br><span class="line">virsh dumpxml vm-node1                           <span class="comment">#查看KVM虚拟机当前配置</span></span><br><span class="line">virsh dumpxml vm-node1 &gt; vm-node1.bak.xml        <span class="comment">#备份vm-node1虚拟机的xml文件，原文件默认路径/etc/libvirt/qemu/vm-node1.xml</span></span><br><span class="line">virsh autostart vm-node1                         <span class="comment">#KVM物理机开机自启动虚拟机，配置后会在此目录生成配置文件/etc/libvirt/qemu/autostart/vm-node1.xml</span></span><br><span class="line">virsh autostart --<span class="built_in">disable</span> vm-node1               <span class="comment">#取消开机自启动</span></span><br><span class="line">virsh console vm-node1                           <span class="comment">#进入虚拟机</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">&lt;domain <span class="built_in">type</span>=<span class="string">&#x27;kvm&#x27;</span> <span class="built_in">id</span>=<span class="string">&#x27;13&#x27;</span>&gt;</span><br><span class="line">  &lt;name&gt;demo-guest1&lt;/name&gt;</span><br><span class="line">  &lt;uuid&gt;409fc837-ef54-48c9-9a47-c62fe383d33d&lt;/uuid&gt;</span><br><span class="line">  &lt;!-- guset可以使用的最大内存，以KB为单位 --&gt;</span><br><span class="line">  &lt;memory unit=<span class="string">&#x27;KiB&#x27;</span>&gt;2097152&lt;/memory&gt;</span><br><span class="line">  &lt;!-- guest启动时内存，可以通过virsh setmem来调整内存，但不能大于最大可使用内存 --&gt;</span><br><span class="line">  &lt;currentMemory unit=<span class="string">&#x27;KiB&#x27;</span>&gt;2097152&lt;/currentMemory&gt;</span><br><span class="line">  &lt;!-- 分配的虚拟cpu --&gt;</span><br><span class="line">  &lt;vcpu placement=<span class="string">&#x27;static&#x27;</span>&gt;2&lt;/vcpu&gt;</span><br><span class="line">  &lt;resource&gt;</span><br><span class="line">    &lt;partition&gt;/machine&lt;/partition&gt;</span><br><span class="line">  &lt;/resource&gt;</span><br><span class="line">  &lt;os&gt;</span><br><span class="line">    &lt;<span class="built_in">type</span> <span class="built_in">arch</span>=<span class="string">&#x27;x86_64&#x27;</span> machine=<span class="string">&#x27;pc-i440fx-rhel7.0.0&#x27;</span>&gt;hvm&lt;/type&gt;</span><br><span class="line">    &lt;boot dev=<span class="string">&#x27;hd&#x27;</span>/&gt;</span><br><span class="line">  &lt;/os&gt;</span><br><span class="line">  &lt;features&gt;</span><br><span class="line">    &lt;acpi/&gt;</span><br><span class="line">    &lt;apic/&gt;</span><br><span class="line">  &lt;!-- 处理器特性 --&gt;</span><br><span class="line">  &lt;/features&gt;</span><br><span class="line">  &lt;cpu mode=<span class="string">&#x27;custom&#x27;</span> match=<span class="string">&#x27;exact&#x27;</span> check=<span class="string">&#x27;full&#x27;</span>&gt;</span><br><span class="line">    &lt;model fallback=<span class="string">&#x27;forbid&#x27;</span>&gt;Skylake-Server-IBRS&lt;/model&gt;</span><br><span class="line">    &lt;feature policy=<span class="string">&#x27;require&#x27;</span> name=<span class="string">&#x27;md-clear&#x27;</span>/&gt;</span><br><span class="line">    &lt;feature policy=<span class="string">&#x27;require&#x27;</span> name=<span class="string">&#x27;spec-ctrl&#x27;</span>/&gt;</span><br><span class="line">    &lt;feature policy=<span class="string">&#x27;require&#x27;</span> name=<span class="string">&#x27;ssbd&#x27;</span>/&gt;</span><br><span class="line">    &lt;feature policy=<span class="string">&#x27;require&#x27;</span> name=<span class="string">&#x27;hypervisor&#x27;</span>/&gt;</span><br><span class="line">    &lt;feature policy=<span class="string">&#x27;disable&#x27;</span> name=<span class="string">&#x27;arat&#x27;</span>/&gt;</span><br><span class="line">  &lt;/cpu&gt;</span><br><span class="line">  &lt;!-- 时钟, 使用本地时间: utc --&gt;</span><br><span class="line">  &lt;clock offset=<span class="string">&#x27;utc&#x27;</span>&gt;</span><br><span class="line">    &lt;timer name=<span class="string">&#x27;rtc&#x27;</span> tickpolicy=<span class="string">&#x27;catchup&#x27;</span>/&gt;</span><br><span class="line">    &lt;timer name=<span class="string">&#x27;pit&#x27;</span> tickpolicy=<span class="string">&#x27;delay&#x27;</span>/&gt;</span><br><span class="line">    &lt;timer name=<span class="string">&#x27;hpet&#x27;</span> present=<span class="string">&#x27;no&#x27;</span>/&gt;</span><br><span class="line">  &lt;/clock&gt;</span><br><span class="line">  &lt;!-- 定义了在kvm环境中crash时的默认的动作分别为destroy和restart。</span><br><span class="line">    destroy：停止该虚拟机。相当于关闭电源。</span><br><span class="line">    restart: 重启虚拟机 --&gt;</span><br><span class="line">  &lt;on_poweroff&gt;destroy&lt;/on_poweroff&gt;</span><br><span class="line">  &lt;on_reboot&gt;restart&lt;/on_reboot&gt;</span><br><span class="line">  &lt;on_crash&gt;destroy&lt;/on_crash&gt;</span><br><span class="line">  &lt;pm&gt;</span><br><span class="line">    &lt;suspend-to-mem enabled=<span class="string">&#x27;no&#x27;</span>/&gt;</span><br><span class="line">    &lt;suspend-to-disk enabled=<span class="string">&#x27;no&#x27;</span>/&gt;</span><br><span class="line">  &lt;/pm&gt;</span><br><span class="line">  &lt;!-- 设备定义开始 --&gt;</span><br><span class="line">  &lt;devices&gt;</span><br><span class="line">    &lt;!-- 模拟器，此处路径为qemu-kvm绝对路径 --&gt;</span><br><span class="line">    &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line">    &lt;!-- 用于kvm启动或者存储的文件,启动设备为：/image/UCarApp1/UCarApp1_clone-disk1.raw --&gt;</span><br><span class="line">    &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line">      &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/image/UCarApp1/UCarApp1_clone-disk1.raw&#x27;</span>/&gt;</span><br><span class="line">      &lt;backingStore/&gt;</span><br><span class="line">      &lt;target dev=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line">      &lt;!-- 可通过--disk 修改磁盘总线类型为ide --disk UCarApp1_clone-disk1.raw,bus=ide --&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;virtio-disk0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x06&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/disk&gt;</span><br><span class="line">    &lt;controller <span class="built_in">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-ehci1&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;usb&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x7&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="built_in">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-uhci1&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;usb&#x27;</span>/&gt;</span><br><span class="line">      &lt;master startport=<span class="string">&#x27;0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span> multifunction=<span class="string">&#x27;on&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="built_in">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-uhci2&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;usb&#x27;</span>/&gt;</span><br><span class="line">      &lt;master startport=<span class="string">&#x27;2&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x1&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="built_in">type</span>=<span class="string">&#x27;usb&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;ich9-uhci3&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;usb&#x27;</span>/&gt;</span><br><span class="line">      &lt;master startport=<span class="string">&#x27;4&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x04&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x2&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> index=<span class="string">&#x27;0&#x27;</span> model=<span class="string">&#x27;pci-root&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;pci.0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;controller <span class="built_in">type</span>=<span class="string">&#x27;virtio-serial&#x27;</span> index=<span class="string">&#x27;0&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;virtio-serial0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x05&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/controller&gt;</span><br><span class="line">    &lt;!-- 采用普通的驱动，即硬盘和网卡都采用默认配置情况下，网卡工作在 模拟的rtl 8139 网卡下，速度为100M 全双工。采用 virtio 驱动后，网卡工作在 1000M 的模式下 --&gt;</span><br><span class="line">    &lt;interface <span class="built_in">type</span>=<span class="string">&#x27;bridge&#x27;</span>&gt;</span><br><span class="line">      &lt;mac address=<span class="string">&#x27;52:54:00:bc:1b:74&#x27;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">source</span> bridge=<span class="string">&#x27;br0&#x27;</span>/&gt;</span><br><span class="line">      &lt;target dev=<span class="string">&#x27;vnet6&#x27;</span>/&gt;</span><br><span class="line">      &lt;model <span class="built_in">type</span>=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;net0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x03&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/interface&gt;</span><br><span class="line">    &lt;serial <span class="built_in">type</span>=<span class="string">&#x27;pty&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">source</span> path=<span class="string">&#x27;/dev/pts/11&#x27;</span>/&gt;</span><br><span class="line">      &lt;target <span class="built_in">type</span>=<span class="string">&#x27;isa-serial&#x27;</span> port=<span class="string">&#x27;0&#x27;</span>&gt;</span><br><span class="line">        &lt;model name=<span class="string">&#x27;isa-serial&#x27;</span>/&gt;</span><br><span class="line">      &lt;/target&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;serial0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/serial&gt;</span><br><span class="line">    &lt;console <span class="built_in">type</span>=<span class="string">&#x27;pty&#x27;</span> <span class="built_in">tty</span>=<span class="string">&#x27;/dev/pts/11&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">source</span> path=<span class="string">&#x27;/dev/pts/11&#x27;</span>/&gt;</span><br><span class="line">      &lt;target <span class="built_in">type</span>=<span class="string">&#x27;serial&#x27;</span> port=<span class="string">&#x27;0&#x27;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;serial0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/console&gt;</span><br><span class="line">    &lt;channel <span class="built_in">type</span>=<span class="string">&#x27;unix&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">source</span> mode=<span class="string">&#x27;bind&#x27;</span> path=<span class="string">&#x27;/var/lib/libvirt/qemu/channel/target/domain-13-demo-guest1/org.qemu.guest_agent.0&#x27;</span>/&gt;</span><br><span class="line">      &lt;target <span class="built_in">type</span>=<span class="string">&#x27;virtio&#x27;</span> name=<span class="string">&#x27;org.qemu.guest_agent.0&#x27;</span> state=<span class="string">&#x27;disconnected&#x27;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;channel0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;virtio-serial&#x27;</span> controller=<span class="string">&#x27;0&#x27;</span> bus=<span class="string">&#x27;0&#x27;</span> port=<span class="string">&#x27;1&#x27;</span>/&gt;</span><br><span class="line">    &lt;/channel&gt;</span><br><span class="line">    &lt;!-- 输入设备 --&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&#x27;tablet&#x27;</span> bus=<span class="string">&#x27;usb&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;input0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;usb&#x27;</span> bus=<span class="string">&#x27;0&#x27;</span> port=<span class="string">&#x27;1&#x27;</span>/&gt;</span><br><span class="line">    &lt;/input&gt;</span><br><span class="line">    &lt;!-- 输入设备 --&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&#x27;mouse&#x27;</span> bus=<span class="string">&#x27;ps2&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;input1&#x27;</span>/&gt;</span><br><span class="line">    &lt;/input&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&#x27;keyboard&#x27;</span> bus=<span class="string">&#x27;ps2&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;input2&#x27;</span>/&gt;</span><br><span class="line">    &lt;/input&gt;</span><br><span class="line">    &lt;!-- 定义与guset交互的图形设备。在这个例子中，使用vnc协议。listen的地址为0.0.0.0的地址。prot为5903,通过以下的命令查找端口号: virsh vncdisplay guestName --&gt;</span><br><span class="line">    &lt;graphics <span class="built_in">type</span>=<span class="string">&#x27;vnc&#x27;</span> port=<span class="string">&#x27;5903&#x27;</span> autoport=<span class="string">&#x27;yes&#x27;</span> listen=<span class="string">&#x27;0.0.0.0&#x27;</span>&gt;</span><br><span class="line">      &lt;listen <span class="built_in">type</span>=<span class="string">&#x27;address&#x27;</span> address=<span class="string">&#x27;0.0.0.0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/graphics&gt;</span><br><span class="line">    &lt;video&gt;</span><br><span class="line">      &lt;model <span class="built_in">type</span>=<span class="string">&#x27;cirrus&#x27;</span> vram=<span class="string">&#x27;16384&#x27;</span> heads=<span class="string">&#x27;1&#x27;</span> primary=<span class="string">&#x27;yes&#x27;</span>/&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;video0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x02&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/video&gt;</span><br><span class="line">    &lt;memballoon model=<span class="string">&#x27;virtio&#x27;</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;balloon0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x07&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/memballoon&gt;</span><br><span class="line">    &lt;rng model=<span class="string">&#x27;virtio&#x27;</span>&gt;</span><br><span class="line">      &lt;backend model=<span class="string">&#x27;random&#x27;</span>&gt;/dev/urandom&lt;/backend&gt;</span><br><span class="line">      &lt;<span class="built_in">alias</span> name=<span class="string">&#x27;rng0&#x27;</span>/&gt;</span><br><span class="line">      &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x08&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line">    &lt;/rng&gt;</span><br><span class="line">  &lt;!-- 设备定义结束 --&gt;</span><br><span class="line">  &lt;/devices&gt;</span><br><span class="line">  &lt;seclabel <span class="built_in">type</span>=<span class="string">&#x27;dynamic&#x27;</span> model=<span class="string">&#x27;selinux&#x27;</span> relabel=<span class="string">&#x27;yes&#x27;</span>&gt;</span><br><span class="line">    &lt;label&gt;system_u:system_r:svirt_t:s0:c47,c808&lt;/label&gt;</span><br><span class="line">    &lt;imagelabel&gt;system_u:object_r:svirt_image_t:s0:c47,c808&lt;/imagelabel&gt;</span><br><span class="line">  &lt;/seclabel&gt;</span><br><span class="line">  &lt;seclabel <span class="built_in">type</span>=<span class="string">&#x27;dynamic&#x27;</span> model=<span class="string">&#x27;dac&#x27;</span> relabel=<span class="string">&#x27;yes&#x27;</span>&gt;</span><br><span class="line">    &lt;label&gt;+107:+107&lt;/label&gt;</span><br><span class="line">    &lt;imagelabel&gt;+107:+107&lt;/imagelabel&gt;</span><br><span class="line">  &lt;/seclabel&gt;</span><br><span class="line">&lt;/domain&gt;</span><br></pre></td></tr></table></figure>



<h1 id="课程中心"><a href="#课程中心" class="headerlink" title="课程中心"></a>课程中心</h1><p><a target="_blank" rel="noopener" href="https://edu.51cto.com/lecturer/13180901.html">Qianj.51CTO</a></p>
</div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/linux/">linux</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/clqz10lg000005gyjbitw3ita.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">python相关配置</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/clqxf75p30000tkyjbl1l5j7u.html"><span class="level-item">virtuoso提示x11 connection rejected because of wrong authentication</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!-->